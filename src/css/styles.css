:root {
  --bg: #000;
  --fg: #03ffaf; /* default glow-ish green */
  --accent: #0ff; /* CLU cyan option will override */
  --control-bg: rgba(16, 16, 16, 0.9);
  --control-fg: #ddd;
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --controls-transition: 240ms ease;
  --controls-shadow: 0 -8px 24px rgba(0, 0, 0, 0.35);
  --controls-safe-pad: 0px; /* can be used if you want extra breathing room */
  --log-info: #a9d1ff;
  --log-debug: #cfcfcf;
  --log-warn: #ffd37a;
  --log-error: #ff9e9e;
  --log-pass: #b8ffb8;
  --log-fail: #ffb0b0;
}

html,
body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #000;
  overflow: hidden;
}

body {
  padding-top: env(safe-area-inset-top);
  padding-right: env(safe-area-inset-right);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
}

#stage {
  position: fixed;
  inset: 0;
  display: block;
  height: 100%;
  width: 100%;
  min-height: 100dvh; /* for mobile */
  min-width: 100dvw; /* for mobile */
  overflow: hidden;
  background: #000;
}

#canvas {
  position: fixed;
  inset: 0;
  background: #000;
  display: block;
  width: 100%;
  min-width: 100dvw;
  height: 100%;
  min-height: 100dvh;
  touch-action: none;
  z-index: 0;
}

.controls {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--control-bg);
  color: var(--control-fg);
  padding: 8px 12px calc(12px + var(--safe-bottom));
  display: grid;
  gap: 6px;
  grid-template-columns: 1fr 1fr 1fr;
  align-items: center;
  /* keep above browser UI */
  z-index: 1000;
}

.clickable {
  cursor: pointer;
}
.controls .row {
  display: flex;
  gap: 8px;
  align-items: baseline;
}
label {
  opacity: 0.8;
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
}
button {
  background: transparent;
  color: inherit;
  border: 1px solid #444;
  padding: 4px 8px;
}

/* Footer controls are fixed to bottom, hidden by default */
#controls {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 2000; /* higher than .reveal-edge (1001) */
  transform: translateY(100%);
  opacity: 0.001;
  pointer-events: none;
  transition:
    transform var(--controls-transition),
    opacity 180ms ease-in;
  box-shadow: var(--controls-shadow);
  will-change: transform, opacity;
}

/* Stack each .row to span the full footer width (one row per line) */
#controls > .row {
  grid-column: 1 / -1; /* span all grid columns */
}

/* Put the Pause / Clear row on the right */
/* Actions row: speed on the left, pause/clear on the right */
#controls .row.actions {
  display: flex; /* ensure it's a flex row */
  justify-content: space-between;
  align-items: center;
  gap: 8px;
}

/* Button group styling */
#controls .row.actions .group {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* (optional) allow the label row to wrap on small screens */
#controls .row.labels {
  flex-wrap: wrap;
}

/* On very narrow screens, allow the actions to wrap nicely */
@media (max-width: 520px) {
  #controls .row.actions {
    flex-wrap: wrap;
  }
  /* Keep Pause/Clear to the right when wrapping */
  #controls .row.actions .group.right {
    margin-left: auto;
  }
}

/* When visible, they slide up and accept interaction */
#controls.is-visible {
  transform: translateY(0);
  opacity: 1;
  pointer-events: auto;
}

/* When controls are visible, push content up so nothing is obscured */
body.has-controls-visible {
  padding-bottom: calc(var(--controls-height, 64px) + var(--controls-safe-pad));
}

/* Mobile-only, invisible bottom-edge reveal zone */
/* Bottom-edge reveal hit area (always interactive) */
.reveal-edge {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: 28px;
  z-index: 1001;
  background: transparent;
  pointer-events: auto; /* <-- make it clickable on all devices */
}

/* Enable the edge only on touch/non-hover devices */
@media (hover: none), (pointer: coarse) {
  .reveal-edge {
    pointer-events: auto;
  }
}
.hud-badge {
  position: fixed;
  bottom: 72px;
  left: 50%;
  transform: translateX(-50%) translateY(8px);
  padding: 6px 10px;
  border-radius: 10px;
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
  font:
    12px/1.2 system-ui,
    sans-serif;
  opacity: 0;
  pointer-events: none;
  transition:
    transform 0.15s ease,
    opacity 0.15s ease;
}
.hud-badge.on {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

.hud-help-wrap {
  margin-top: 8px;
  opacity: 0.9;
}
.hud-help {
  display: grid;
  gap: 2px;
  font-size: 11px;
}
.hud-help .alt {
  opacity: 0.7;
  margin-left: 6px;
}

/* ===== Visual Noise â€” Toasts ===== */

/* Container */
.vn-toasts {
  position: fixed;
  z-index: 2147483646;
  pointer-events: none; /* container lets clicks pass through */
  display: flex;
  gap: 8px;
}

/* When footer menu is visible, raise bottom-positioned toasts above it */
body.has-controls-visible .pos-bottom-center,
body.has-controls-visible .pos-bottom-left,
body.has-controls-visible .pos-bottom-right {
  bottom: calc(16px + var(--controls-height, 64px) + var(--controls-safe-pad, 0px));
}

/* Position modifiers */
.pos-top-left {
  top: 16px;
  left: 16px;
  flex-direction: column;
}
.pos-top-right {
  top: 16px;
  right: 16px;
  flex-direction: column;
}
.pos-top-center {
  top: 16px;
  left: 50%;
  transform: translateX(-50%);
  flex-direction: column;
}
.pos-bottom-left {
  bottom: 16px;
  left: 16px;
  flex-direction: column-reverse;
}
.pos-bottom-right {
  bottom: 16px;
  right: 16px;
  flex-direction: column-reverse;
}
.pos-bottom-center {
  bottom: 16px;
  left: 50%;
  transform: translateX(-50%);
  flex-direction: column-reverse;
}

/* Toast */
.vn-toast {
  pointer-events: auto; /* individual toasts clickable to dismiss */
  border-radius: 9999px; /* capsule */
  padding: 10px 14px;
  min-width: 200px;
  max-width: 90vw;

  color: #fff;
  background: rgba(20, 24, 28, 0.92);
  border: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.35);

  opacity: 0;
  transform: translateY(10px);
  transition:
    transform 160ms ease,
    opacity 160ms ease;

  -webkit-font-smoothing: antialiased;
  user-select: none;
  font:
    500 13px/1.25 system-ui,
    -apple-system,
    Segoe UI,
    Roboto,
    sans-serif;

  backdrop-filter: saturate(120%) blur(6px);
}
.vn-toast.vn-in {
  transform: translateY(0);
  opacity: 1;
}

/* Row layout */
.vn-row {
  display: flex;
  align-items: baseline;
  gap: 10px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.vn-title {
  opacity: 0.8;
  font-weight: 600;
  letter-spacing: 0.3px;
  text-transform: uppercase;
  font-size: 11px;
  flex: 0 0 auto;
}
.vn-msg {
  font-weight: 700;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1 1 auto;
}

/* Channel accents */
.vn-toast[data-channel='notify.genre'] {
  background: rgba(20, 60, 40, 0.92);
}
.vn-toast[data-channel='notify.style'] {
  background: rgba(60, 20, 40, 0.92);
}
.vn-toast[data-channel='notify.vibe'] {
  background: rgba(40, 40, 40, 0.92);
}

.vn-toast[data-channel='notify.speed'] {
  background: rgba(40, 40, 70, 0.92);
}
.vn-toast[data-channel='notify.state'] {
  background: rgba(30, 30, 30, 0.92);
}
.vn-toast[data-channel='notify.power'] {
  background: rgba(30, 50, 60, 0.92);
}
.vn-toast[data-channel='notify.fire.height'] {
  background: rgba(60, 30, 10, 0.92);
}
.vn-toast[data-channel='notify.fire.fuel'] {
  background: rgba(60, 30, 10, 0.92);
}

@media (prefers-reduced-motion: reduce) {
  .vn-toast {
    transition: none;
    transform: none;
  }
  .vn-toast.vn-in {
    transform: none;
  }
}
