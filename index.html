<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Peripheral Crypto Log</title>
  <style>
    :root { --bg: #0b0c10; --fg: #9fffb3; --dim: #3a5; --accent: #00d18f; --glow: rgba(0, 255, 136, .4); --panel: rgba(0,0,0,.6); }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body { margin:0; background: var(--bg); color: var(--fg); font: 400 12px/1.45 ui-monospace, SFMono-Regular, Menlo, Consolas, "Cascadia Mono", "Liberation Mono", monospace; overflow:hidden; -webkit-font-smoothing: antialiased; text-rendering: optimizeSpeed; }

    #dock { position: fixed; right: 12px; bottom: 12px; width: min(40vw, 520px); height: min(40vh, 300px); background: var(--panel); border: 1px solid #1c1; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,.6), inset 0 0 18px var(--glow); padding: 10px 12px 8px; display:flex; flex-direction: column; backdrop-filter: blur(3px) saturate(1.2); z-index: 9999; }
    #dock.max { inset: 0 !important; width: 100vw !important; height: 100vh !important; left: 0 !important; top: 0 !important; right: 0 !important; bottom: 0 !important; border-radius: 0; padding: 14px 16px; }
    #title { font-weight: 600; letter-spacing:.06em; color: var(--accent); display:flex; align-items:center; gap:8px; user-select:none; cursor:move; margin-bottom:6px; }
    #title .dot { width:8px; height:8px; border-radius:50%; background: #16ff6b; box-shadow: 0 0 12px 2px #16ff6b }

    #terminal { flex:1; overflow:hidden; position: relative; }
    #lines { position:absolute; inset:0; overflow: hidden; }
    .line { white-space: pre; word-break: break-all; text-shadow: 0 0 8px var(--glow); line-height: 1.55; font-variant-ligatures: none; }
    .line.bar { text-shadow: none; font-family: Consolas, "Cascadia Mono", "Courier New", monospace; font-size: 95%; line-height: 1.55; }

    #footer { display:flex; flex-wrap: wrap; gap:10px; font-size: 10px; color:#9aa; opacity:.9; margin-top:6px; user-select:none; justify-content: space-between; align-items:center; }
    .group { display:flex; gap:6px; align-items:center }
    button { background:#111; border:1px solid #333; border-radius:6px; padding: 2px 8px; font-size: 10px; color:#bdf; cursor:pointer; }
    button:hover { background:#222; border-color:#555; }
    .badge { border:1px solid #3a3; border-radius: 999px; padding:2px 8px; color:#9fffb3; }

    .scanlines::after { content:""; position:absolute; inset:0; background-image: linear-gradient(rgba(255,255,255,.05) 1px, transparent 1px); background-size: 100% 3px; pointer-events:none; mix-blend-mode: overlay; opacity:.12; }
    .flicker { animation: flicker 6s infinite steps(60); }
    @keyframes flicker { 0%,100% { opacity: 1 } 50% { opacity: .98 } 60% { opacity: .92 } 70% { opacity: .99 } }
    .blink::after { content: "▋"; margin-left:2px; animation: blink 1s step-end infinite; }
    @keyframes blink { 50% { opacity: 0 } }
  </style>
</head>
<body>
  <div id="dock" class="scanlines flicker">
    <div id="title"><span class="dot"></span><span>crypto-log • idle</span></div>
    <div id="terminal">
      <div id="lines"></div>
    </div>
    <div id="footer">
      <div class="group">
        <button id="speedDown">-</button>
        <button id="speedUp">+</button>
        speed
      </div>
      <div class="group">
        <button data-theme="matrix">Matrix</button>
        <button data-theme="amber">Amber</button>
        <button data-theme="cyan">Cyan</button>
      </div>
      <div class="group">
        <span class="badge">mode: <span id="modeName">crypto</span></span>
        <button data-mode="crypto">Crypto</button>
        <button data-mode="sysadmin">Sysadmin</button>
      </div>
      <div class="group">
        <span class="badge">bar: <span id="barName">dots2</span></span>
        <button data-bar="dots">░</button>
        <button data-bar="dots2">·</button>
        <button data-bar="dash">-</button>
        <button data-bar="space">␠</button>
      </div>
      <div class="group">
        <button id="pauseBtn">Pause</button>
        <button id="clearBtn">Clear</button>
        <button id="dockBtn">Dock</button>
        <button id="fullBtn">Full</button>
      </div>
    </div>
  </div>

  <script>
  (() => {
    // --- Config ---
    const cfg = {
      minDelay: 120,
      maxDelay: 220,
      lineInterval: [180,520],
      maxLines: 160,
      theme: 'matrix',
      dock: 'br',
      intensity: 1,
      persona: 'crypto',
      barStyle: 'dots2' // default now uses centered dot (·)
    };
    // Edge tends to render U+2591 (░) tall; pick a safer default there
    try {
      if (navigator.userAgent && navigator.userAgent.includes('Edg')) {
        cfg.barStyle = 'dots2';
      }
    } catch (_) {}
    const themes = {
      matrix: { bg:'#0b0c10', fg:'#a9ffb6', accent:'#00d18f', glow:'rgba(0,255,136,.4)', border:'#1c1' },
      amber:  { bg:'#0a0700', fg:'#ffd18a', accent:'#ffae00', glow:'rgba(255,170,0,.35)', border:'#5a3' },
      cyan:   { bg:'#001318', fg:'#9de7ff', accent:'#2ad1ff', glow:'rgba(42,209,255,.35)', border:'#154a57' }
    };

    const barStyles = {
      dots:  { fill:'█', empty:'░' },
      dots2: { fill:'█', empty:'·' },
      dash:  { fill:'█', empty:'-' },
      space: { fill:'█', empty:' ' }
    };

    const dockPositions = {
      br: { right:'12px', left:'auto', bottom:'12px', top:'auto' },
      bl: { left:'12px', right:'auto', bottom:'12px', top:'auto' },
      tr: { right:'12px', left:'auto', top:'12px', bottom:'auto' },
      tl: { left:'12px', right:'auto', top:'12px', bottom:'auto' }
    };

    const dockEl = document.getElementById('dock');
    const titleEl = document.getElementById('title').querySelector('span:nth-child(2)');
    const linesEl = document.getElementById('lines');
    const fullBtn = document.getElementById('fullBtn');
    const modeName = document.getElementById('modeName');
    const barName = document.getElementById('barName');

    function applyTheme(name){
      const t = themes[name] || themes.matrix;
      document.documentElement.style.setProperty('--bg', t.bg);
      document.documentElement.style.setProperty('--fg', t.fg);
      document.documentElement.style.setProperty('--accent', t.accent);
      document.documentElement.style.setProperty('--glow', t.glow);
      dockEl.style.borderColor = t.border;
    }
    function applyDock(pos){ Object.assign(dockEl.style, dockPositions[pos] || dockPositions.br); }
    applyTheme(cfg.theme); applyDock(cfg.dock);

    // Shared helpers
    const rBetween = (min,max)=> Math.random()*(max-min)+min;
    const rInt = (min,max)=> Math.floor(rBetween(min, max+1));
    const pick = (arr)=> arr[rInt(0, arr.length-1)];
    const randHex = (len)=> Array.from({length:len}, ()=> Math.floor(Math.random()*16).toString(16)).join('');
    const timeStamp = ()=> new Date().toTimeString().slice(0,8);

    // Crypto content
    const loremWords = ("lorem ipsum dolor sit amet consectetur adipiscing elit sed do eiusmod tempor incididunt ut labore et dolore magna aliqua ut enim ad minim veniam quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat").split(' ');
    const cryptoCmds = ['handshake','derive-key','expand-key','encrypt','decrypt','rotate-keys','seal','unseal','attest','generate-iv','hkdf','pbkdf2','scrypt','argon2','sha256','sha512','blake3','keccak','sign','verify'];
    const cryptoPrefixes = ['INFO','WARN','TRACE','DEBUG'];
    const cryptoPathbits = ['srv','vault','node','shard','cluster','core','io','bus','net','gpu0','gpu1','cpu0','mem','cache','disk0'];
    let progress = 0;
    function lorem(n){ return Array.from({length:n}, ()=> pick(loremWords)).join(' '); }

    function makeProgBar(pct){
      const width = 20;
      const { fill, empty } = barStyles[cfg.barStyle] || barStyles.dots2;
      const filled = Math.round(pct/100*width);
      return fill.repeat(filled) + empty.repeat(width-filled);
    }

    function makeLineCrypto(){
      const choice = Math.random();
      if(choice < 0.16){
        progress += rInt(1,7); if(progress > 100) progress = 0;
        const bar = makeProgBar(progress);
        return `[${timeStamp()}] ${pick(cryptoPrefixes)}   PROG ${String(progress).padStart(3,' ')}%  [${bar}]`;
      } else if(choice < 0.32) {
        const bytes = Array.from({length: rInt(8,16)}, () => randHex(2)).join(' ');
        return `[${timeStamp()}] HEX   ${randHex(8)}: ${bytes}`;
      } else if(choice < 0.48) {
        const cmd = pick(cryptoCmds);
        const node = pick(cryptoPathbits)+'/'+pick(cryptoPathbits)+'/'+rInt(0,9);
        return `[${timeStamp()}] ${pick(cryptoPrefixes)}   ${cmd} --src ${node} --key 0x${randHex(16)} --iv 0x${randHex(8)} ... ok`;
      } else if(choice < 0.64) {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
        let s=''; const len=rInt(22,54); for(let i=0;i<len;i++) s += chars[rInt(0,chars.length-1)];
        return `[${timeStamp()}] BLOB  ${s}==`;
      } else if(choice < 0.80) {
        return `[${timeStamp()}] NOTE  ${lorem(rInt(6,14))}.`;
      } else {
        return `[${timeStamp()}] STAT  latency=${rInt(2,80)}ms  shards=${rInt(1,6)}  temp=${(rBetween(35,78)).toFixed(1)}°C  nonce=0x${randHex(6)}`;
      }
    }

    // Sysadmin content (unchanged)...

    // (rest of the JS unchanged from your version)
  })();
  </script>
</body>
</html>
